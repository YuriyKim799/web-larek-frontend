# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание данных

```
Данные, используемые в проекте представлены интерфейсами ICard и IOrder.

Интерфейс ICard описывает конкретный товар, для покупки в интернет магазине, содержит данные которые присылает сервер, для описания товара.

 interface ICard { 
  _id: string;           уникальный индентификатор
  description: string;   описание товара
  image: string;         ссылка на изображение товара
  title: string;         название товара
  category: string;      категория товара
  price: number;         цена товара
}

Интерфейс IOrder описывает объект заказа отправляемый на сервер, содержит массив id товаров добавленных в заказ, а также данные покупателя и общую стоимость заказов.

interface IOrder {      
  payment: string;     метод оплаты заказа
  email: string;       почта покупателя
  phone: string;       номер телефона покупателя
  address: string;     адрес доставки
  total: number;       общая стоимость заказа
  items: string[];     массив id товаров добавленных в заказ
}

Интерфейс IOrderResult описывает возращаемый объект с сервера после успешной отправки формы заказа.

interface IOrderResult {
	id: string;
	total: number;
}

Интерфейс IBasket описывает объект корзины покупок содержит в себе массив id карточек добавленных в корзину и счетчик общей стоимости товаров 

interface IBasket {
  cards: string[],
  total: number
}

Интерфейс OrderForm описывает объект формы заказа, и что б не дублировать код используем утилиту Omit которая создаёт новый тип, исключая указанные свойства из исходного типа. Т.е. вырезаем 'total' | 'items' из интерфейса IOrder.

type OrderForm = Omit<IOrder, 'total' | 'items'>;
```

## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.
  
 #### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события
- `trigger` - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.  

#### Абстрактный базовый класс Component
Класс является дженериком и родителем всех компонентов слоя представления. В дженерик принимает тип объекта, в котором данные будут передаваться в метод render для отображения данных в компоненте. В конструктор принимает элемент разметки, являющийся основным родительским контейнером компонента. Содержит метод render, отвечающий за сохранение полученных в параметре данных в полях компонентов через их сеттеры, возвращает обновленный контейнер компонента.

#### Базовый класс View
Класс View расширяет Component, добавляя в конструктор параметр events, он служит прослойкой между Component и конкретными представлениями, добавляя функционал для работы с событиями.

### Слой данных (Model). Основные классы.

#### Класс AppData
Класс отвечает за хранение и логику работы с данными.

Конструктор класса принимает инстант брокера событий

В полях класса хранятся следующие данные:

 items: ICard[];

 previewCard: ICard = null;
 
  basket: IBasket = { 
    cards: [],
    total: 0
  };

  formErrors = {};

  order: IOrder = {
    payment: 'online',
    email: '',
    phone: '',
    address: '',
    total: 0,
    items: []
  };

  функция setCards(){}

  функция setPreview(){}

  функция inBasket(){}

  функция addToBasket(){}

  функция removeFromBasket(){}

  функция clearBasket(){}

  функция setPayMethod(){}

  функция setOrderField(){}

  функция validateOrder(){}


